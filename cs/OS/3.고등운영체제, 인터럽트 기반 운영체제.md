# 고등운영체제, 인터럽트 기반 운영체제



<details>
<summary>Q. 컴퓨터 부팅시 어떤 일이 일어날 까?</summary>
<div markdown="1">

```text
사용자가 컴퓨터의 전원을 켜면 롬(ROM)에 저장된 바이오스가 실행된다. 바이오스는 CPU, 메모리, 하드디스크, 키보드 등의 주요 하드웨어가 제대로 작동하는 지 확인하다.
이상이 없으면 이후 하드디스크의 마스터 부트 레코드(MBR)에 저장된 작은 프로그램(부트스트랩)을 메모리로 가져와 실행한다.
부트스트랩이 메모리에 올라오면 비로소 하드디스크에 있는 저장된 운영체제를 메모리로 불러오게 된다. 


참고로, 마스터 부트 레코드는 하드디스크의 첫번 째 섹터를 가리키는데, 이 곳에는 운영체제를 실행하기 위한 부트스트랩(bootstrap) 이 저장되어 있다.
```

</div>
</details>

<details>
<summary>Q. OS 부팅 후 마우스를 움직이면 CPU는 무엇을 할까?</summary>
<div markdown="1">

```text
마우스를 움직이게 되면 전기적 신호가 컴퓨터로 전송될 것이다. 
인터럽트 선으로 전기신호를 보내게 되면 컴퓨터 내부의 cpu는 인터럽트를 인지할 것이다.
이때 cpu는 도중에 하던 작업을 멈추고 OS 내부의 마우스 인터럽트 서비스 루틴(ISR)을 실행시켜 원하는 동작(움직임)을 하도록 한다.
결국 인터럽트걸린 후 OS 내부의 인터럽트 서비스 루틴(ISR)이 실행 되어 움직이는 마우스를 볼 수 있는 것이다.
```

</div>
</details>

# 고등 운영체제

## 다중 프로세서(Multiprocessor system)

메모리가 하나이지만 cpu(프로세서) 가 여러개 있는 경우

- 병렬 시스템(parallel system)
- 강결합 시스템(tightly-coupled system)
- 3가지 장점: performance, cost, reliability)
    - 일반적으로 강한 거 하나 쓰는 거 보다 성능은 좀 떨어지는 거 여러개 쓰는 게 저렴! (cost)
- ***다중 프로세서 운영체제(Multiprocessor OS)***
    - 스케쥴링 자체가 달라짐
    - Linux 도 지원함

## 분산 시스템(Distributed system)

- 다중 컴퓨터 시스템(multi-computer system)
- 소결합 시스템(loosely-coupled system)
    - 그림에서처럼 각 컴퓨터는 물리적으로 직접 연결되어 있는 것이 아닌 LAN, 네트워크로 연결되어 있다. 강결합 X
- 분산 운영체제(Distributed OS)
    - 또한 다중프로세서 처럼 성능, 비용, 신뢰성 문제 해결
        - 성능 : 하나가 아닌 여러개의 프로세서 사용
        - 신뢰성 : 하나의 노드가 죽더라도 다른 곳에서 처리 가능
    - 당연히 서로간의 메시지를 주고 받아야 하기 때문에 일반 OS와 달라야 한다. 하나의 목표를 위해!

## 실시간 시스템(Real-time system)

어떤 계산이 반드시 특정 시간안에 끝내야 하는 경우

- 시간 제약: Deadline
- 공장 자동화 (FA), 군사, 항공, 우주
- 실시간 운영체제(Real-time OS = RTOS)

# 인터럽트 기반 시스템(Interrupt Based System)

## 현대 운영체제는 인터럽트 기반 시스템!

## 인터럽트

### 부팅이 끝나면?

- 운영체제는 메모리에 상주(resident)
- 사건(event) 을 기다리며 대기: 키보드, 마우스 …

### 하드웨어 인터럽트 ( Hardware interrupt)

- 마우스 클릭, 마우스 커서 이동, 키보드 입력 등등 ..
- 인터럽트 결과 운영체제내의 특정 코드 실행(**ISR = 인터럽트 서비스 루틴**)
- Interrupt Service Routine 종료 후 다시 대기

### 소프트웨어 인터럽트 (Software interrupt)

- 사용자 프로그램이 실행되면서 소프트웨어 인터럽트 (운영체제 서비스 이용 위해)
    - 가령 아래한글 프로그램을 통해 특정 파일을 불러오는 행위, 이 경우 파일을 불러오기 위해서 디스크 IO가 일어나게 되는 데 이때 인터럽트가 일어난다. (하드디스크 인터럽트 서비스 루틴)
- 인터럽트 결과 운영체제 내의 특정 코드 실행(ISR)
    - SWI, INT(팬티엄)

```text

🗨️ 요약

운영체제는 평소에는 대기 상태이다. 인터럽트가 일어나면 OS 안의 ‘코드’가 실행된다.
구체적으로, 하드웨어 인터럽트, 소프트웨어 인터럽트, 내부 인터럽트(Interrnal Interrupt) 에 의해 운영체제 코드 (ISR)가 실행된다.

그리고 ISR 코드 실행이 끝나면(종료) 원래의 대기상태 또는 사용자 프로그램 으로 복귀

```

### 내부 인터럽트(traps)

컴퓨터 시스템 내부에서 발생하는 이벤트 또는 조건에 의해 일어나는 인터럽트이다. 내부 인터럽트는 다양한 상황에서 발생할 수 있지만, 일반적으로 아래와 같은 경우에 발생한다. 즉, 잘못된 명령이나 데이터를 사용할 때 발생하는 인터럽트

- Attempt to divide by zero, Stack overflow, 프로그램에서 함수 등 명령어를 잘못 사용한 경우

실제, OS 안에는 당연히 “Dived by Zero” 라는 것을 처리하는 인터럽트 루틴 서비스(ISR)가 있다. 해당 코드에는 잘못된 코드를 실행한 프로그램을 강제로 종료하도록 되어있다.